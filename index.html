<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concours de P√™che</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-blue-900 text-white font-sans">
    <div id="app" class="max-w-md mx-auto p-4">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-2xl font-bold flex items-center gap-2">
                <span>üêü</span> CONCOURS PRO
            </h1>
            <button onclick="deconnexion()" class="text-xs bg-blue-800 px-3 py-1 rounded">Quitter</button>
        </header>

        <div id="menu-principal" class="space-y-4">
            <button onclick="afficherPage('inscription')" class="w-full bg-white text-blue-900 font-bold py-6 rounded-2xl shadow-xl text-xl">
                üìù INSCRIRE UN P√äCHEUR
            </button>
            <button onclick="afficherPage('pesee')" class="w-full bg-blue-500 text-white font-bold py-6 rounded-2xl shadow-xl text-xl border-2 border-blue-400">
                ‚öñÔ∏è ENREGISTRER UNE PES√âE
            </button>
            <button onclick="afficherPage('classement')" class="w-full bg-yellow-500 text-blue-900 font-bold py-6 rounded-2xl shadow-xl text-xl">
                üèÜ CLASSEMENT G√âN√âRAL
            </button>
        </div>

        <div id="page-inscription" class="hidden animate-fade-in">
            <button onclick="afficherPage('menu')" class="mb-4 text-blue-300">‚Üê Retour</button>
            <div class="bg-white text-blue-900 p-6 rounded-2xl shadow-2xl">
                <h2 class="text-xl font-bold mb-4 text-center">NOUVELLE INSCRIPTION</h2>
                <input type="text" id="nom-pecheur" placeholder="Nom du p√™cheur" class="w-full p-4 border-2 border-blue-100 rounded-xl mb-4 text-lg">
                <select id="poste-pecheur" class="w-full p-4 border-2 border-blue-100 rounded-xl mb-6 text-lg">
                    <option value="">Choisir un poste</option>
                    <script>
                        for(let i=1; i<=20; i++) document.write(`<option value="${i}">Poste ${i}</option>`);
                    </script>
                </select>
                <button onclick="validerInscription()" class="w-full bg-green-500 text-white font-bold py-4 rounded-xl text-lg shadow-lg">
                    VALIDER L'ENTR√âE
                </button>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURATION
        const firebaseConfig = {
            apiKey: "AIzaSyB44m6DoeyQSNMctS0hKlpaPR5vNOTNsW0",
            authDomain: "concours-peche.firebaseapp.com",
            projectId: "concours-peche",
            storageBucket: "concours-peche.firebasestorage.app",
            messagingSenderId: "376446532224",
            appId: "1:376446532224:web:4f9c1ffd2f4fe3ef450465"
        };

        // INITIALISATION
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // FONCTIONS DE NAVIGATION
        function afficherPage(id) {
            document.getElementById('menu-principal').classList.add('hidden');
            document.getElementById('page-inscription').classList.add('hidden');
            
            if(id === 'menu') {
                document.getElementById('menu-principal').classList.remove('hidden');
            } else {
                document.getElementById('page-' + id).classList.remove('hidden');
            }
        }

        // LOGIQUE INSCRIPTION (Lien direct avec ton Firestore)
        async function validerInscription() {
            const nom = document.getElementById('nom-pecheur').value;
            const poste = document.getElementById('poste-pecheur').value;

            if(!nom || !poste) {
                alert("Remplis tout !");
                return;
            }

            try {
                // On utilise le nom de collection "fishermen" que tu as cr√©√© sur l'image
                await db.collection("fishermen").add({
                    nom: nom,
                    poste: parseInt(poste),
                    poidsTotal: 0,
                    date: firebase.firestore.FieldValue.serverTimestamp()
                });
                alert("P√™cheur enregistr√© avec succ√®s !");
                document.getElementById('nom-pecheur').value = "";
                afficherPage('menu');
            } catch (error) {
                alert("Erreur : " + error.message);
            }
        }

        function deconnexion() {
            if(confirm("Quitter l'app ?")) window.location.reload();
        }
    </script>

    <style>
        .hidden { display: none; }
        .animate-fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</body>
</html>
