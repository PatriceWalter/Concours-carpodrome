<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Concours de PÃªche PRO</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fish-gradient { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script>
        const firebaseConfig = {
          apiKey: "AIzaSyB44m6DoeyQSNMctS0hKlpaPR5vNOTNsW0",
          authDomain: "concours-peche.firebaseapp.com",
          projectId: "concours-peche",
          storageBucket: "concours-peche.firebasestorage.app",
          messagingSenderId: "376446532224",
          appId: "1:376446532224:web:4f9c1ffd2f4fe3ef450465"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const { useState, useEffect, createElement: h } = React;

        function App() {
            const [user, setUser] = useState(null);
            const [page, setPage] = useState('loading');
            const [selectedPoste, setSelectedPoste] = useState(null);
            const [nom, setNom] = useState('');

            useEffect(() => {
                auth.onAuthStateChanged(u => {
                    if(u) { setUser(u); setPage('menu'); }
                    else { setUser(null); setPage('login'); }
                });
            }, []);

            const inscrirePecheur = async () => {
                if(!nom) return alert("Nom requis");
                await db.collection("fishermen").add({
                    name: nom,
                    poste: selectedPoste,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    totalWeight: 0
                });
                alert("PÃªcheur inscrit au poste " + selectedPoste);
                setNom('');
                setPage('menu');
            };

            // Ã‰CRAN CONNEXION
            if (page === 'login') {
                return h('div', { className: 'min-h-screen fish-gradient flex items-center justify-center p-6' },
                    h('div', { className: 'bg-white rounded-2xl p-8 w-full max-w-md shadow-2xl text-center' },
                        h('div', { className: 'text-5xl mb-4' }, 'ðŸŸ'),
                        h('h1', { className: 'text-2xl font-black text-blue-900 mb-6' }, 'CONCOURS DE PÃŠCHE'),
                        h('input', { id:'em', type:'email', placeholder:'Email admin', className:'w-full p-3 mb-3 border rounded-xl' }),
                        h('input', { id:'pw', type:'password', placeholder:'Code secret', className:'w-full p-3 mb-6 border rounded-xl' }),
                        h('button', { 
                            onClick: () => auth.signInWithEmailAndPassword(document.getElementById('em').value, document.getElementById('pw').value),
                            className: 'w-full fish-gradient text-white font-bold py-4 rounded-xl' 
                        }, 'DÃ‰MARRER LE CONCOURS')
                    )
                );
            }

            // MENU PRINCIPAL
            if (page === 'menu') {
                return h('div', { className: 'min-h-screen' },
                    h('div', { className: 'fish-gradient p-6 text-white flex justify-between items-center shadow-lg' },
                        h('h1', { className: 'font-black text-xl' }, 'GESTION CONCOURS'),
                        h('button', { onClick: () => auth.signOut(), className: 'bg-red-500/20 px-4 py-2 rounded-lg text-sm' }, 'Quitter')
                    ),
                    h('div', { className: 'p-6 grid grid-cols-2 gap-4' },
                        [1,2,3,4,5,6,7,8,9,10,11,12].map(n => h('button', {
                            onClick: () => { setSelectedPoste(n); setPage('inscription'); },
                            className: 'bg-white p-8 rounded-2xl border-2 border-blue-100 shadow-sm flex flex-col items-center hover:border-blue-500'
                        }, 
                            h('span', { className: 'text-gray-400 text-sm mb-1' }, 'POSTE'),
                            h('span', { className: 'text-3xl font-black text-blue-900' }, n)
                        ))
                    )
                );
            }

            // FORMULAIRE INSCRIPTION
            if (page === 'inscription') {
                return h('div', { className: 'min-h-screen p-6' },
                    h('button', { onClick: () => setPage('menu'), className: 'mb-6 text-blue-600 font-bold' }, 'â† Retour aux postes'),
                    h('div', { className: 'bg-white rounded-2xl p-6 shadow-xl border-t-4 border-blue-600' },
                        h('h2', { className: 'text-xl font-black mb-4 uppercase' }, `Inscription Poste ${selectedPoste}`),
                        h('label', { className: 'block text-sm font-bold text-gray-500 mb-2' }, 'NOM DU PÃŠCHEUR'),
                        h('input', { 
                            value: nom, onChange: (e) => setNom(e.target.value),
                            placeholder: 'Ex: Jean Dupont', className: 'w-full p-4 border-2 rounded-xl mb-6 text-lg' 
                        }),
                        h('button', { 
                            onClick: inscrirePecheur,
                            className: 'w-full fish-gradient text-white font-bold py-4 rounded-xl shadow-lg' 
                        }, 'VALIDER L\'INSCRIPTION')
                    )
                );
            }

            return h('div', { className: 'min-h-screen flex items-center justify-center' }, 'Chargement...');
        }

        ReactDOM.render(h(App), document.getElementById('root'));
    </script>
</body>
</html>
